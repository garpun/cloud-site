{
  "swagger": "2.0",
  "info": {
    "title": "generator.proto"
  },
  "schemes": null,
  "consumes": null,
  "produces": null,
  "paths": {
    "/v2/projects": {
      "post": {
        "summary": "Добавление проекта (клиента)",
        "description": "Упрощенное создание проекта. В проектах создаются алгоритмы",
        "operationId": "Create",
        "responses": {
          "200": {
            "description": "",
            "schema": {
              "$ref": "#/definitions/CreateProjectResponse"
            }
          }
        },
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/CreateProjectRequest"
            }
          }
        ],
        "tags": [
          "Project"
        ]
      }
    },
    "/v2/projects/{project_id}/algorithms": {
      "post": {
        "summary": "Добавить алгоритм",
        "description": "Создает алгоритм в проекте (клиенте), но не запускает его.\nДля запуска используется метод Start",
        "operationId": "Create",
        "responses": {
          "200": {
            "description": "",
            "schema": {
              "$ref": "#/definitions/AlgorithmResponse"
            }
          }
        },
        "parameters": [
          {
            "name": "project_id",
            "in": "path",
            "required": true,
            "type": "string",
            "format": "int64"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/AlgorithmParams"
            }
          }
        ],
        "tags": [
          "Algorithm"
        ]
      }
    },
    "/v2/projects/{project_id}/algorithms/{id}": {
      "put": {
        "summary": "Редактировать алгоритм",
        "description": "Редактирует ранее созданный алгоритм",
        "operationId": "Update",
        "responses": {
          "200": {
            "description": "",
            "schema": {
              "$ref": "#/definitions/AlgorithmResponse"
            }
          }
        },
        "parameters": [
          {
            "name": "project_id",
            "in": "path",
            "required": true,
            "type": "string",
            "format": "int64"
          },
          {
            "name": "id",
            "in": "path",
            "required": true,
            "type": "string",
            "format": "int64"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/AlgorithmParams"
            }
          }
        ],
        "tags": [
          "Algorithm"
        ]
      }
    },
    "/v2/projects/{project_id}/algorithms/{id}/start": {
      "post": {
        "summary": "Запустить генерацию рекламы по алгоритму",
        "description": "Ставит задачу на запуск генерации по алгоритму, в ответе id задачи",
        "operationId": "Start",
        "responses": {
          "200": {
            "description": "",
            "schema": {
              "$ref": "#/definitions/AlgorithmStartResponse"
            }
          }
        },
        "parameters": [
          {
            "name": "project_id",
            "in": "path",
            "required": true,
            "type": "string",
            "format": "int64"
          },
          {
            "name": "id",
            "in": "path",
            "required": true,
            "type": "string",
            "format": "int64"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "$ref": "#/definitions/AlgorithmStartRequest"
            }
          }
        ],
        "tags": [
          "Algorithm"
        ]
      }
    }
  },
  "definitions": {
    "AlgorithmParams": {
      "type": "object",
      "properties": {
        "projectId": {
          "type": "integer",
          "format": "int64",
          "title": "@required ID проекта (клиента). Включен в url запроса",
          "description": "ID проекта (клиента). Включен в url запроса"
        },
        "id": {
          "type": "integer",
          "format": "int64",
          "title": "Идентификатор алгоритма передается только при редактировании алгоритма",
          "description": "Идентификатор алгоритма передается только при редактировании алгоритма"
        },
        "type": {
          "type": "string",
          "title": "@required Тип алгоритма.\nУточните у вашего интеграционного менеджера что вам надо передевать в этот параметр",
          "description": "Тип алгоритма.\nУточните у вашего интеграционного менеджера что вам надо передевать в этот параметр"
        },
        "name": {
          "type": "string",
          "title": "@required Название алгоритма",
          "description": "Название алгоритма"
        },
        "sourceUrl": {
          "type": "string",
          "title": "@required Ссылка на источник данных",
          "description": "Ссылка на источник данных"
        },
        "geo": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "title": "Array of string",
          "description": "Коды георегионов\nСм. DataHub справочник [garpun_main.geo_region](/api_datahub/dicts/garpun_main__geo_region/)"
        },
        "engineSettings": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/EngineSettings"
          },
          "title": "Array of EngineSettings",
          "description": "Настройки для внешних систем"
        },
        "updateSchedule": {
          "type": "string",
          "title": "Mixed type",
          "description": "Идентификатор расписания обновлений\nМожно передавать в двух вариантах:\n- в виде строки (daily, weekly, never, unknown):\n- в виде объекта, ключами которого являются часы обновления алгоритма, значениями - дни недели, в которые в эти часы будет запущено обновление. (0 - воскресение, 1- понедельник и т.д. до 6 - суббота)\nНапример, если передать структуру, показанную ниже, алгоритм будет обновляться в 00-00 по понедельниками, средам и пятницам, и в 13-00 по воскресениям, средам и субботам.\n```\n{\n   \"0\": [1, 3, 5],\n   \"13\": [0, 3, 6]\n}\n```\nВажно! Если вы будете передавать объект, то при его сериализации в json не помещайте его в строку. Пример:\n```\n{\n   ...,\n   \"sourceUrl\": \"URL\",\n   \"geo\": [ \"RU-MOW\" ],\n   \"updateSchedule\": { /* обратите внимание, что объект передается не строкой */\n     \"0\": [1, 3, 5],\n     \"13\": [0, 3, 6]\n   },\n   ...\n}\n```"
        },
        "campaignsNames": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "title": "Array of string",
          "description": "Массив имен кампаний, которыми заменяются имена в настройках алгоритма.\nИспользуется только при создании алгоритма.\nПример ['Новая кампания', 'Новая кампания 2'] или [1 => 'Новая кампания 2']"
        }
      },
      "required": [
        "projectId",
        "type",
        "name",
        "sourceUrl",
        "engineSettings",
        "updateSchedule"
      ]
    },
    "AlgorithmResponse": {
      "type": "object",
      "properties": {
        "id": {
          "type": "integer",
          "format": "int64",
          "title": "Идентификатор алгоритма",
          "description": "Идентификатор алгоритма"
        },
        "type": {
          "type": "string",
          "title": "Тип алгоритма",
          "description": "Тип алгоритма"
        },
        "name": {
          "type": "string",
          "title": "Название алгоритма",
          "description": "Название алгоритма"
        },
        "sourceUrl": {
          "type": "string",
          "title": "ВНИМАНИЕ! В ответе придет sourceURL",
          "description": "ВНИМАНИЕ! В ответе придет sourceURL"
        },
        "geo": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "title": "Array of string",
          "description": "Коды георегионов\nСм. DataHub справочник [garpun_main.geo_region](/api_datahub/dicts/garpun_main__geo_region/)"
        },
        "engineSettings": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/EngineSettings"
          },
          "title": "Array of EngineSettings",
          "description": "Настройки для внешних систем"
        },
        "updateSchedule": {
          "type": "string",
          "title": "Идентификатор расписания обновлений\nВ виде строки (daily, weekly, never, unknown)",
          "description": "Идентификатор расписания обновлений\nВ виде строки (daily, weekly, never, unknown)"
        }
      },
      "required": []
    },
    "AlgorithmStartRequest": {
      "type": "object",
      "properties": {
        "projectId": {
          "type": "integer",
          "format": "int64",
          "title": "@required ID проекта (клиента). Включен в url запроса",
          "description": "ID проекта (клиента). Включен в url запроса"
        },
        "id": {
          "type": "integer",
          "format": "int64",
          "title": "Идентификатор алгоритма",
          "description": "Идентификатор алгоритма"
        }
      },
      "required": [
        "projectId"
      ]
    },
    "AlgorithmStartResponse": {
      "type": "object",
      "properties": {
        "taskId": {
          "type": "integer",
          "format": "int64",
          "title": "Algorithm TaskStageId\nПолучить список можно через справочник [garpun_main.generator_tasks_report](/api_datahub/dicts/garpun_main__generator_tasks_report/)",
          "description": "Algorithm TaskStageId\nПолучить список можно через справочник [garpun_main.generator_tasks_report](/api_datahub/dicts/garpun_main__generator_tasks_report/)"
        },
        "algorithmId": {
          "type": "integer",
          "format": "int64",
          "title": "Идентификатор алгоритма",
          "description": "Идентификатор алгоритма"
        },
        "dateTarget": {
          "type": "integer",
          "format": "int64",
          "title": "Дата в формате YYYY-MM-DD hh:mm:ss\nНапример: 2020-10-21 09:00:00",
          "description": "Дата в формате YYYY-MM-DD hh:mm:ss\nНапример: 2020-10-21 09:00:00"
        }
      },
      "required": []
    },
    "CreateProjectRequest": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string",
          "title": "@required Название проекта (клиента)",
          "description": "Название проекта (клиента)"
        }
      },
      "required": [
        "name"
      ]
    },
    "CreateProjectResponse": {
      "type": "object",
      "properties": {
        "id": {
          "type": "integer",
          "format": "int64",
          "title": "ID проекта (клиента)",
          "description": "ID проекта (клиента)"
        },
        "name": {
          "type": "string",
          "title": "Название проекта (клиента)",
          "description": "Название проекта (клиента)"
        }
      },
      "required": []
    },
    "EngineSettings": {
      "type": "object",
      "properties": {
        "engine": {
          "type": "string",
          "title": "@required Идентификатор внешней системы\nСм. DataHub справочник [adplatform.engine](/api_datahub/dicts/adplatform__engine/)\nПоддерживаются значения: yandex или google",
          "description": "Идентификатор внешней системы\nСм. DataHub справочник [adplatform.engine](/api_datahub/dicts/adplatform__engine/)\nПоддерживаются значения: yandex или google"
        },
        "externalAccountId": {
          "type": "integer",
          "format": "int64",
          "title": "@required Идентификатор Аккаунта внешней системы",
          "description": "Идентификатор Аккаунта внешней системы"
        },
        "defaultClickPrice": {
          "type": "number",
          "format": "float",
          "title": "Ставка по умолчанию",
          "description": "Ставка по умолчанию"
        },
        "minusKeywords": {
          "type": "string",
          "title": "Список минус-фраз через запятую",
          "description": "Список минус-фраз через запятую"
        },
        "campaignType": {
          "type": "string",
          "title": "Только для Google AdWords\nsearchNetwork - Только поисковая сеть\nsearchNetworkWithDisplaySelect - Поисковая сеть и оптимизированная контекстно-медийная сеть",
          "description": "Только для Google AdWords\nsearchNetwork - Только поисковая сеть\nsearchNetworkWithDisplaySelect - Поисковая сеть и оптимизированная контекстно-медийная сеть"
        },
        "campaignBidType": {
          "type": "string",
          "title": "Только для Яндекс Директ\nall - Все площадки\nsearch - Только на поиске\nnetwork - Только в сетях",
          "description": "Только для Яндекс Директ\nall - Все площадки\nsearch - Только на поиске\nnetwork - Только в сетях"
        },
        "additionalYandexMetricCounters": {
          "type": "array",
          "items": {
            "type": "string"
          },
          "title": "Array of string",
          "description": "Только для Яндекс Директ. Индентификаторы счетчиков Яндекс Метрики"
        },
        "networkSettings": {
          "$ref": "#/definitions/NetworkSettingsParams",
          "title": "Настройки в сетях. Только для Яндекс директ и если campaignBidType = all",
          "description": "Настройки в сетях. Только для Яндекс директ и если campaignBidType = all"
        }
      },
      "required": [
        "engine",
        "externalAccountId"
      ]
    },
    "NetworkSettingsParams": {
      "type": "object",
      "properties": {
        "useBlock": {
          "type": "string",
          "title": "@required\nИспользовать настройки блока:\nalways - Всегда\nonlyNewCampaign - Только при создании РК\nnever - Никогда",
          "description": "Использовать настройки блока:\nalways - Всегда\nonlyNewCampaign - Только при создании РК\nnever - Никогда"
        },
        "enableParams": {
          "type": "boolean",
          "format": "boolean",
          "title": "Флаг использования настроек на темаических площадках",
          "description": "Флаг использования настроек на темаических площадках"
        },
        "limitPercent": {
          "type": "integer",
          "format": "int32",
          "description": null
        },
        "bidPercent": {
          "type": "integer",
          "format": "int32",
          "description": null
        },
        "enableBehavioralTargeting": {
          "type": "boolean",
          "format": "boolean",
          "title": "Не учитывать предпочтения пользователей",
          "description": "Не учитывать предпочтения пользователей"
        }
      },
      "required": [
        "useBlock"
      ]
    }
  },
  "tags": [
    {
      "name": "Algorithm",
      "description": "Генерация рекламных кампаний\nПолучить список можно через справочник [adplatform.algorithm](/api_datahub/dicts/adplatform__algorithm/)"
    },
    {
      "name": "Project",
      "description": "Создание проекта (клиента)\nВ DataHub и остальной части Garpun эта сущость называется Клиент\nПолучить список можно через справочник [adplatform.client](/api_datahub/dicts/adplatform__client/)"
    }
  ]
}